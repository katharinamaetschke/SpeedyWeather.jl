<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Function and type index · SpeedyWeather.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpeedyWeather.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../how_to_run_speedy/">How to run SpeedyWeather.jl</a></li><li><a class="tocitem" href="../spectral_transform/">Spherical harmonic transform</a></li><li><a class="tocitem" href="../dynamical_core/">Dynamical core</a></li><li><a class="tocitem" href="../parametrizations/">Parameterizations</a></li><li><a class="tocitem" href="../boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../new_model_setups/">New model setups</a></li><li class="is-active"><a class="tocitem" href>Function and type index</a><ul class="internal"><li><a class="tocitem" href="#Parameters-and-constants"><span>Parameters and constants</span></a></li><li><a class="tocitem" href="#Boundaries-and-boundary-conditions"><span>Boundaries and boundary conditions</span></a></li><li><a class="tocitem" href="#Spherical-harmonic-transform"><span>Spherical harmonic transform</span></a></li><li><a class="tocitem" href="#Geometry"><span>Geometry</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time stepping</span></a></li></ul></li><li><a class="tocitem" href="../conventions/">Style and convention guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Function and type index</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Function and type index</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/milankl/SpeedyWeather.jl/blob/master/docs/src/functions.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Function-and-type-index"><a class="docs-heading-anchor" href="#Function-and-type-index">Function and type index</a><a id="Function-and-type-index-1"></a><a class="docs-heading-anchor-permalink" href="#Function-and-type-index" title="Permalink"></a></h1><h2 id="Parameters-and-constants"><a class="docs-heading-anchor" href="#Parameters-and-constants">Parameters and constants</a><a id="Parameters-and-constants-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters-and-constants" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.Parameters" href="#SpeedyWeather.Parameters"><code>SpeedyWeather.Parameters</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Parameter struct that holds all parameters that define the default model setup. With keywords such that default values can be changed at creation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/default_parameters.jl#L1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.Constants" href="#SpeedyWeather.Constants"><code>SpeedyWeather.Constants</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Struct holding the parameters needed at runtime in number format NF.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/constants.jl#L1-L3">source</a></section></article><h2 id="Boundaries-and-boundary-conditions"><a class="docs-heading-anchor" href="#Boundaries-and-boundary-conditions">Boundaries and boundary conditions</a><a id="Boundaries-and-boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Boundaries-and-boundary-conditions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.Boundaries" href="#SpeedyWeather.Boundaries"><code>SpeedyWeather.Boundaries</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Struct that holds the boundary arrays in grid-point space     geopot<em>surf     ::Array{Complex{NF},2}  # spectral surface geopotential (orography * gravity) [m^2/s^2]     landsea</em>mask    ::Array{NF,2}           # land-sea mask, grid-point     albedo          ::Array{NF,2}           # annual mean surface albedo, grid-point</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/boundaries.jl#L1-L6">source</a></section></article><h2 id="Spherical-harmonic-transform"><a class="docs-heading-anchor" href="#Spherical-harmonic-transform">Spherical harmonic transform</a><a id="Spherical-harmonic-transform-1"></a><a class="docs-heading-anchor-permalink" href="#Spherical-harmonic-transform" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.GeoSpectral" href="#SpeedyWeather.GeoSpectral"><code>SpeedyWeather.GeoSpectral</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">G = Geospectral{NF}(geometry,spectral_transform)</code></pre><p>Struct that holds both a Geometry struct <code>geometry</code> and a SpectralTransform struct <code>spectral_transform</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_transform.jl#L163-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.SpectralTransform" href="#SpeedyWeather.SpectralTransform"><code>SpeedyWeather.SpectralTransform</code></a> — <span class="docstring-category">Type</span></header><section><div><p>SpectralTransform struct that contains all parameters and preallocated arrays for the spectral transform.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_transform.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.spectral" href="#SpeedyWeather.spectral"><code>SpeedyWeather.spectral</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">alms = spectral(map)</code></pre><p>Forward spectral transform (grid to spectral space) from the gridded field <code>map</code> on a regular Gaussian grid (with Gaussian latitudes) into the spectral coefficients of the Legendre polynomials <code>alms</code>. Based on the size of <code>map</code> this function retrieves the corresponding spectral resolution via triangular truncation and sets up a SpectralTransform struct <code>S</code> to execute <code>spectral(map,S)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_transform.jl#L396-L402">source</a></section><section><div><pre><code class="nohighlight hljs">alms = spectral(map,S)</code></pre><p>Forward spectral transform (grid to spectral space) from the gridded field <code>map</code> on a regular Gaussian grid (with Gaussian latitudes) and the SpectralTransform struct <code>S</code> into the spectral coefficients of the Legendre polynomials <code>alms</code>. This function allocates <code>alms</code> and executes <code>spectral!(alms,map,S)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_transform.jl#L421-L426">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.spectral!" href="#SpeedyWeather.spectral!"><code>SpeedyWeather.spectral!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">spectral!(alms,map,S)</code></pre><p>Forward spectral transform (grid to spectral space) from the gridded field <code>map</code> on a regular Gaussian grid (with Gaussian latitudes). Uses a planned real-valued Fast Fourier Transform in the zonal direction, and a Legendre Transform in the meridional direction exploiting symmetries.Either recomputes the Legendre polynomials <code>Λ</code> for each latitude on one hemisphere or uses precomputed polynomials from <code>S.Λs</code>, depending on <code>S.recompute_legendre</code>. Further uses Legendre weights on Gaussian latitudes for a leakage-free transform.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_transform.jl#L337-L345">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.gridded" href="#SpeedyWeather.gridded"><code>SpeedyWeather.gridded</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">map = gridded(alms)</code></pre><p>Backward or inverse spectral transform (spectral to grid space) from coefficients <code>alms</code>. Based on the size of <code>alms</code> the corresponding grid space resolution is retrieved based on triangular truncation and a  SpectralTransform struct <code>S</code> is allocated to execute <code>gridded(alms,S)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_transform.jl#L301-L306">source</a></section><section><div><pre><code class="nohighlight hljs">map = gridded(alms,S)</code></pre><p>Backward or inverse spectral transform (spectral to grid space) from coefficients <code>alms</code> and the  SpectralTransform struct <code>S</code>. Allocates the output <code>map</code> with Gaussian latitudes and executes <code>gridded!(map,alms,S)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_transform.jl#L322-L327">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.gridded!" href="#SpeedyWeather.gridded!"><code>SpeedyWeather.gridded!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gridded!(map,alms,S)</code></pre><p>Backward or inverse spectral transform (spectral to grid space) from coefficients <code>alms</code> and SpectralTransform struct <code>S</code> into the preallocated output <code>map</code>. Uses a planned inverse Fast Fourier Transform for efficiency in the zonal direction and a Legendre Transform in the meridional direction exploiting symmetries for effciency. Either recomputes the Legendre polynomials to save memory, or uses precomputed polynomials from <code>S</code> depending on <code>S.recompute_legendre</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_transform.jl#L239-L246">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.triangular_truncation" href="#SpeedyWeather.triangular_truncation"><code>SpeedyWeather.triangular_truncation</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">triangular_truncation(trunc::Int,nlon::Int,nlat::Int)</code></pre><p>Tests whether the inputs <code>trunc, nlon, nlat</code> satisfy the triangular truncation constraints. <code>trunc</code> is the maximum degree and order of the Legendre polynomials (0-based), <code>nlon</code> is the number of longitudes, <code>nlat</code> the number of latitudes on the spatial grid. The constraints are</p><pre><code class="nohighlight hljs">- nlon &gt;= 3T+1
- nlat &gt;= (3T+1)/2
- nlon = 2nlat.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_truncation.jl#L29-L38">source</a></section><section><div><pre><code class="nohighlight hljs">nlon, nlat = triangular_truncation(trunc::Int)</code></pre><p>Returns the grid size <code>nlon,nlat</code> for a spectral truncation <code>trunc</code> that satisfies the triangular truncation constraints. Returns the smallest pair <code>nlon,nlat</code> that is also easily Fast Fourier-transformable, as determined in <code>roundup_fft</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_truncation.jl#L48-L53">source</a></section><section><div><pre><code class="nohighlight hljs">trunc = triangular_truncation(nlon::Int,nlat::Int)</code></pre><p>Returns the largest spectral truncation <code>trunc</code> that satisfies the triangular truncation constraints based on the grid size <code>nlon,nlat</code>, which may or may not be easily Fast Fourier-transformable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_truncation.jl#L61-L65">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.roundup_fft" href="#SpeedyWeather.roundup_fft"><code>SpeedyWeather.roundup_fft</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">m = roundup_fft(n::Int;
                small_primes::Vector{Int}=[2,3,5])</code></pre><p>Returns an integer <code>m &gt;= n</code> with only small prime factors 2, 3, 5 (default, others can be specified with the keyword argument <code>small_primes</code>) to obtain an efficiently fourier-transformable number of longitudes, m = 2^i * 3^j * 5^k &gt;= n, with i,j,k &gt;=0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_truncation.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.spectral_truncation" href="#SpeedyWeather.spectral_truncation"><code>SpeedyWeather.spectral_truncation</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">alms_trunc = spectral_truncation(alms,trunc)</code></pre><p>Returns a spectral coefficient matrix <code>alms_trunc</code> that is truncated from <code>alms</code> to the size (<code>trunc</code>+1)^2. <code>alms_trunc</code> only contains those coefficient of <code>alms</code> for which m,l &lt;= trunc, and m&gt;l are zero anyway. If <code>trunc</code> is larger than the implicit truncation in <code>alms</code> obtained from its size than <code>spectral_interpolation</code> is automatically called instead, returning <code>alms_interp</code>, a coefficient matrix that is larger than <code>alms</code> with padded zero coefficients.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_truncation.jl#L116-L123">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.spectral_truncation!" href="#SpeedyWeather.spectral_truncation!"><code>SpeedyWeather.spectral_truncation!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">spectral_truncation!(alms,ltrunc,mtrunc)</code></pre><p>Truncate spectral coefficients <code>alms</code> in-place by setting (a) the upper right triangle to zero and (b) all coefficients for which the degree <code>l</code> is larger than the truncation <code>ltrunc</code> or order <code>m</code> larger than the truncaction <code>mtrunc</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_truncation.jl#L72-L77">source</a></section><section><div><pre><code class="nohighlight hljs">spectral_truncation!(alms,trunc)</code></pre><p>Truncate spectral coefficients <code>alms</code> in-place by setting (a) the upper right triangle to zero and (b) all coefficients for which the degree l is larger than the truncation <code>trunc</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_truncation.jl#L98-L102">source</a></section><section><div><pre><code class="nohighlight hljs">spectral_truncation!(alms)</code></pre><p>Truncate spectral coefficients <code>alms</code> in-place by setting the upper right triangle to zero. This is to enforce that all coefficients for which the degree l is larger than order m are zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_truncation.jl#L109-L113">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.get_legendre_polynomials!" href="#SpeedyWeather.get_legendre_polynomials!"><code>SpeedyWeather.get_legendre_polynomials!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Λview = get_legendre_polynomials!(Λ,Λs,ilat,cos_colat,recompute_legendre)</code></pre><p>Base on <code>recompute_legendre</code> (true/false) this function either updates the Legendre polynomials <code>Λ</code> for a given latitude <code>ilat, cos_colat</code> by recomputation (<code>recompute_legendre == true</code>), or <code>Λ</code> is changed by creating a view on the corresponding latitude in precomputed <code>Λs</code>. Recomputation takes usually longer, but precomputation requires a large amount of memory for high resolution. Returns a view in both cases.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_transform.jl#L214-L221">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.∇²!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.∇²</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.∇⁴!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.∇⁴</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.∇⁻²!" href="#SpeedyWeather.∇⁻²!"><code>SpeedyWeather.∇⁻²!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">∇⁻²!(   ∇⁻²alms::AbstractMatrix{Complex},
        alms::AbstractMatrix{Complex},
        R::Real=1)</code></pre><p>Inverse spherical Laplace operator ∇⁻² applied to the spectral coefficients <code>alms</code> on a sphere of radius <code>R</code>. ∇⁻²! is the in-place version which directly stores the output in the argument ∇⁻²alms. The integration constant for Legendre polynomial <code>l=m=0</code> is zero. The inverse spherical Laplace operator is</p><pre><code class="nohighlight hljs">∇⁻²alms = alms*R²/(-l(l+1))</code></pre><p>with the degree <code>l</code> (0-based) of the Legendre polynomial.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_gradients.jl#L142-L154">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.∇⁻²</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.gradient_latitude!" href="#SpeedyWeather.gradient_latitude!"><code>SpeedyWeather.gradient_latitude!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gradient_latitude!( coslat_u::AbstractArray{Complex{NF}},   # output: cos(lat)*zonal velocity u
                    Ψ::AbstractArray{Complex{NF}},          # input: streamfunction Ψ
                    ϵlms::AbstractArray{NF},                # recursion factors
                    R::Real=1                               # radius of the sphere/Earth
                    ) where {NF&lt;:AbstractFloat}             # number format NF</code></pre><p>Meridional gradient in spectral space of spherical harmonic coefficients <code>Ψ</code> on a sphere with radius R. Returns <code>coslat_u</code>, i.e. the gradient ∂Ψ/∂lat with an additional cosine of latitude scaling. This function uses the recursion relation (0-based degree l, order m)</p><pre><code class="nohighlight hljs">(coslat u)_lm = -1/R*(-(l-1)*ϵ_lm*Ψ_l-1,m + (l+2)*ϵ_l+1,m*Ψ_l+1,m ).</code></pre><p>As u = -1/R*∂Ψ/∂lat, this function can be generally used to compute the gradient in latitude.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_gradients.jl#L1-L14">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.gradient_latitude</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.gradient_longitude!" href="#SpeedyWeather.gradient_longitude!"><code>SpeedyWeather.gradient_longitude!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">coslat_v = gradient_longitude!( coslat_v::AbstractMatrix{Complex{NF}},
                                Ψ::AbstractMatrix{Complex{NF}};
                                radius::Real=1
                                ) where {NF&lt;:AbstractFloat}</code></pre><p>Zonal gradient in spectral space of spherical harmonic coefficients <code>Ψ</code> on a sphere with radius <code>radius</code>. While the zonal gradient has a 1/cos(lat) scaling in spherical coordinates, this functions omits the scaling such that the returned array is scaled with coslat.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_gradients.jl#L62-L71">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.gradient_longitude" href="#SpeedyWeather.gradient_longitude"><code>SpeedyWeather.gradient_longitude</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Gradient in longitude in spectral space. Input: coefficients <code>alms</code> of the spherical harmonics.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_gradients.jl#L100">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.divergence_uvω_spectral</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.ϵlm" href="#SpeedyWeather.ϵlm"><code>SpeedyWeather.ϵlm</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ϵ = ϵ(NF,l,m)</code></pre><p>Recursion factors <code>ϵ</code> as a function of degree <code>l</code> and order <code>m</code> (0-based) of the spherical harmonics. ϵ(l,m) = sqrt((l^2-m^2)/(4*l^2-1)) and then converted to number format NF.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_transform.jl#L182-L186">source</a></section><section><div><pre><code class="nohighlight hljs">ϵ = ϵ(l,m)</code></pre><p>Recursion factors <code>ϵ</code> as a function of degree <code>l</code> and order <code>m</code> (0-based) of the spherical harmonics. ϵ(l,m) = sqrt((l^2-m^2)/(4*l^2-1)) with default number format Float64.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/spectral_transform.jl#L191-L195">source</a></section></article><h2 id="Geometry"><a class="docs-heading-anchor" href="#Geometry">Geometry</a><a id="Geometry-1"></a><a class="docs-heading-anchor-permalink" href="#Geometry" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.Geometry" href="#SpeedyWeather.Geometry"><code>SpeedyWeather.Geometry</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Geometry struct containing parameters and arrays describing the Gaussian grid and the vertical levels. NF is the number format used for the precomputed constants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/geometry.jl#L1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.vertical_coordinates" href="#SpeedyWeather.vertical_coordinates"><code>SpeedyWeather.vertical_coordinates</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Vertical sigma coordinates defined by their nlev+1 half levels <code>σ_levels_half</code>. Sigma coordinates are fraction of surface pressure (p/p0) and are sorted from top (stratosphere) to bottom (surface). The first half level is at 0 the last at 1. Evaluate a generalised logistic function with coefficients in <code>P</code> for the distribution of values in between. Default coefficients follow the L31 configuration historically used at ECMWF.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/geometry.jl#L131-L136">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.GenLogisticCoefs" href="#SpeedyWeather.GenLogisticCoefs"><code>SpeedyWeather.GenLogisticCoefs</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Coefficients of the generalised logistic function to describe the vertical coordinate. Default coefficients A,K,C,Q,B,M,ν are fitted to the old L31 configuration at ECMWF. See geometry.jl and function vertical_coordinate for more informaiton.</p><p>Following the notation of https://en.wikipedia.org/wiki/Generalised<em>logistic</em>function (Dec 15 2021).</p><p>Change default parameters for more/fewer levels in the stratosphere vs troposphere vs boundary layer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/parameter_structs.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.generalised_logistic" href="#SpeedyWeather.generalised_logistic"><code>SpeedyWeather.generalised_logistic</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Generalised logistic function based on the coefficients in <code>coefs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/geometry.jl#L148">source</a></section></article><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.time_stepping!" href="#SpeedyWeather.time_stepping!"><code>SpeedyWeather.time_stepping!</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Main time loop.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/time_integration.jl#L164">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.time_step!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.first_timestep!</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.leapfrog!" href="#SpeedyWeather.leapfrog!"><code>SpeedyWeather.leapfrog!</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Leapfrog! for 3D arrays that loops over all vertical layers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/distributed_vertical.jl#L79">source</a></section><section><div><pre><code class="nohighlight hljs">leapfrog!(  A::AbstractArray{Complex{NF},3},        # a prognostic variable (spectral)
            tendency::AbstractMatrix{Complex{NF}},  # tendency (dynamics+physics) of A
            dt::NF,                                 # time step (=2Δt, but for init steps =Δt,Δt/2)
            C::Constants{NF},                       # struct with constants used at runtime
            lf::Int=2                               # leapfrog index to dis/enable(default) William&#39;s filter
            ) where {NF&lt;:AbstractFloat}             # number format NF</code></pre><p>Performs one leapfrog time step with or without Robert+William&#39;s filter (see William (2009), Montly Weather Review, Eq. 7-9).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/time_integration.jl#L1-L11">source</a></section><section><div><p>A leapfrog! function that loops over all prognostic variables.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/milankl/SpeedyWeather.jl/blob/868530e586cc33aff01835410161c09cc839041b/src/time_integration.jl#L49">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../new_model_setups/">« New model setups</a><a class="docs-footer-nextpage" href="../conventions/">Style and convention guide »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.17 on <span class="colophon-date" title="Tuesday 17 May 2022 16:31">Tuesday 17 May 2022</span>. Using Julia version 1.6.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
